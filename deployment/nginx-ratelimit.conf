# Nginx Rate Limiting Configuration for Wayfarer
#
# This configuration adds rate limiting to protect against:
# - Brute force attacks on login pages
# - Scanner bots
# - DDoS attempts
# - Excessive API calls
#
# DOCUMENTATION:
# For complete installation instructions, customization guide, and troubleshooting:
# See 26-Deployment.md - Section "Security Hardening / Rate Limiting"
#
# IMPORTANT: This file contains PLACEHOLDERS - customize before deploying!

# =============================================================================
# RATE LIMIT ZONES (Add these to http {} block)
# =============================================================================

# General traffic - 10 requests per second per IP with burst of 20
limit_req_zone $binary_remote_addr zone=wayfarer_general:10m rate=10r/s;

# Login pages - 3 requests per minute per IP (stricter)
limit_req_zone $binary_remote_addr zone=wayfarer_login:10m rate=3r/m;

# API endpoints - 20 requests per second per IP
limit_req_zone $binary_remote_addr zone=wayfarer_api:10m rate=30r/s;

# Malicious scanner detection - track 404s
limit_req_zone $binary_remote_addr zone=wayfarer_404:10m rate=5r/m;

# Connection limit per IP
limit_conn_zone $binary_remote_addr zone=wayfarer_conn:10m;
