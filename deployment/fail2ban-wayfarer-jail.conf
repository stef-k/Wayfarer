# Fail2ban jail configuration for Wayfarer
#
# DOCUMENTATION:
# For complete installation instructions, customization guide, and monitoring:
# See docs/developer/13-Deployment.md - Section "Security Hardening / Fail2ban"
#
# QUICK INSTALLATION:
# 1. Install filter first: sudo cp deployment/fail2ban-wayfarer-filter.conf /etc/fail2ban/filter.d/wayfarer.conf
# 2. Add this config to /etc/fail2ban/jail.local (customize logpath first!)
# 3. sudo systemctl restart fail2ban
#
# CRITICAL: Update 'logpath' below to match your actual Wayfarer log location
# (Check appsettings.json for your log path)

[wayfarer-scanner]
# Ban bots scanning for vulnerabilities (.php files, WordPress, etc.)
enabled  = true
port     = http,https
filter   = wayfarer
# CUSTOMIZE: Update this path to your actual Wayfarer log file location
# Common locations:
#   - /var/log/wayfarer/wayfarer.log
#   - /var/www/wayfarer/logs/wayfarer.log
#   - /home/username/wayfarer/logs/wayfarer.log
logpath = /var/log/wayfarer/wayfarer-%(date).log
maxretry = 10
findtime = 600
bantime  = 3600
action   = iptables-multiport[name=wayfarer, port="http,https", protocol=tcp]

[wayfarer-login]
# Ban repeated failed login attempts
enabled  = true
port     = http,https
filter   = wayfarer
# CUSTOMIZE: Update this path to your actual Wayfarer log file location
logpath = /var/log/wayfarer/wayfarer-%(date).log
maxretry = 5
findtime = 300
bantime  = 7200
action   = iptables-multiport[name=wayfarer-login, port="http,https", protocol=tcp]

# Optional: Email notifications
# action   = iptables-multiport[name=wayfarer-login, port="http,https", protocol=tcp]
#            sendmail-whois[name=wayfarer-login, dest=your-email@example.com]
