@{
    var groupId = (Guid)ViewBag.GroupId;
    var group = (Wayfarer.Models.Group)ViewBag.Group;
    ViewData["Title"] = $"Map - {group.Name}";
    ViewData["BodyClass"] = "container-fluid d-flex flex-column flex-fill p-0";
}

<div class="d-flex justify-content-between align-items-center mb-2">
  <h2>@ViewData["Title"]</h2>
  <a class="btn btn-secondary" asp-area="Manager" asp-controller="Groups" asp-action="Index">Back</a>
  <input type="hidden" id="groupId" value="@groupId" />
</div>

<div class="row">
  <div class="col-md-3">
    <h5>Members</h5>
    @using (Html.BeginForm())
    {
        @Html.AntiForgeryToken()
    }
    <div class="mb-2">
      <input id="userSearch" type="search" class="form-control form-control-sm" placeholder="Search users..." autocomplete="off" />
    </div>
    <div id="userSidebar" class="list-group" style="max-height:70vh; overflow:auto">
      @{
          var members = (IEnumerable<dynamic>)ViewBag.Members;
      }
      <label class="list-group-item">
        <input type="checkbox" id="selectAllUsers" class="form-check-input me-1" checked />
        Select All
      </label>
      @foreach (var u in members)
      {
          <div class="list-group-item d-flex justify-content-between align-items-center user-item" data-filter="@u.UserName @u.DisplayName">
            <label class="mb-0 flex-grow-1">
              <input type="checkbox" class="form-check-input me-1 user-select" checked data-user-id="@u.Id" data-username="@u.UserName" />
              @u.UserName (@u.DisplayName)
            </label>
            <div class="btn-group btn-group-sm">
              <button type="button" class="btn btn-outline-primary only-this" data-user-id="@u.Id">Only</button>
              <button type="button" class="btn btn-outline-danger remove-user" data-user-id="@u.Id">Remove</button>
            </div>
          </div>
      }
    </div>
  </div>
  <div class="col-md-9">
    <div id="groupMap" style="height:70vh; width:100%"></div>
  </div>
</div>

<script src="~/lib/leaflet/leaflet-src.js"></script>
<link rel="stylesheet" href="~/lib/leaflet/leaflet-1.9.4.css" />
<script src="~/js/Areas/Manager/Groups/map.js"></script>
