---
id: TM-007
title: Org Peer Visibility Settings APIs
status: done
labels: [api]
deps: [TM-002]
inputs:
  - design/Trusted Managers Mechanism.md
outputs: []
timebox: "2h"
---

## Summary
Add two endpoints: group-level toggle for organizational peer visibility and per-user opt-out within an Organization group.

## Acceptance Criteria (measurable)
- [x] POST /api/groups/{id}/settings/org-peer-visibility updates group-level flag (admin only).
- [x] POST /api/groups/{id}/members/{userId}/org-peer-visibility-access updates personal opt-out (self only).
- [x] Authorization enforced; returns 200 and persists flags.

## Steps
- [x] Read inputs
- [x] Implement endpoints and validation
- [x] Persist flags on Group/GroupMember
- [x] Add basic tests for auth boundaries
- [x] Update spec/index.yml

## Verification
- curl -X POST /api/groups/{id}/settings/org-peer-visibility -d '{"enabled":true}'
- curl -X POST /api/groups/{id}/members/{userId}/org-peer-visibility-access -d '{"disabled":true}'

## Notes
Only applicable for Type=Organisation groups.
