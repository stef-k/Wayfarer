---
id: TM-010
title: Manager UI - Map and SSE
status: done
labels: [ui, sse]
deps: [TM-006]
inputs:
  - design/Trusted Managers Mechanism.md
outputs: []
timebox: "2h"
---

## Summary
Implement Manager map view with group/user picker and a Leaflet map subscribing to per-user SSE channels; follow timeline logic: a) live (threshold), b) last (latest), c) rest.

## Acceptance Criteria (measurable)
- [x] Areas/Manager/Views/Groups/Map.cshtml renders picker + map layout.
- [x] wwwroot/js/Areas/Manager/Groups/map.js loads latest/query endpoints and SSE updates.
- [x] Marker colors/icons match public timeline rules (live vs last).
- [x] Per-user coloring (latest + rest) and hover shows user context.
- [x] Sidebar supports search, Select All, and "Only this" quick filter.
 - [x] Show All / Hide All apply immediately to selection and SSE.
 - [x] Optional chronological controls (day/month/year) available; date-filtered viewport results reflect selection.

## Steps
- [x] Read inputs
- [x] Build Razor view layout
- [x] Implement JS to call endpoints and subscribe SSE
- [x] Test with multiple users; verify visibility rules applied
- [x] Update spec/index.yml

## Verification
- dotnet run â†’ /Manager/Groups/Map?groupId=...
- Observe SSE updates when selected users move; markers update in real time

## Notes
Subscribe to channels like location-update-{username} via existing SseService.
