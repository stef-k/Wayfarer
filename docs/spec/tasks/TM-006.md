---
id: TM-006
title: API - Group Locations (Latest, Query)
status: todo
labels: [api, sse]
deps: [TM-002, TM-005]
inputs:
  - design/Trusted Managers Mechanism.md
outputs: []
timebox: "2h"
---

## Summary
Implement endpoints for latest locations and viewport queries scoped to group membership, reusing LocationService and applying visibility rules.

## Acceptance Criteria (measurable)
- [ ] POST /api/groups/{groupId}/locations/latest returns latest per selected userIds.
- [ ] POST /api/groups/{groupId}/locations/query respects bbox + zoom and returns paged results.
- [ ] Authorization and visibility rules (friends/family vs org) enforced.

## Steps
- [ ] Read inputs
- [ ] Add controller endpoints and request models
- [ ] Reuse LocationService DTOs and thresholds
- [ ] Implement visibility rules per group type and settings
- [ ] Update spec/index.yml

## Verification
- curl -X POST /api/groups/{groupId}/locations/latest -H "Content-Type: application/json" -d '{"includeUserIds":["..."]}'
- curl -X POST /api/groups/{groupId}/locations/query -H "Content-Type: application/json" -d '{"minLng":...,"minLat":...,"maxLng":...,"maxLat":...,"zoomLevel":12,"userIds":["..."]}'

## Notes
Keep endpoints non-public; authorize per group membership.

