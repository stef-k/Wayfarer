---
id: T-005
title: Mobile latest & query endpoints
status: done
labels: [api, backend]
deps: [T-001, T-002, T-003, T-004]
owner: ""
inputs:
  - design/MobileGroups.md
outputs: []
timebox: "2h"
---

## Summary
Implement /api/mobile/groups/{id}/locations/latest and /api/mobile/groups/{id}/locations/query using GroupTimelineService, mirroring existing backend behaviour while enforcing token-auth membership and visibility rules.

## Acceptance Criteria (measurable)
- [x] Both endpoints exist under /api/mobile/groups/{id}/locations/* returning PublicLocationDto payloads aligned with the design.
- [x] Requests enforce membership/visibility and return 401/403 when the caller lacks access.
- [x] Integration test(s) cover latest + query flows (Friends vs Organisation, multi-user day restriction).

## Steps
- [x] Read inputs
- [x] Implement latest/query actions in mobile controller using shared service
- [x] Add/adjust integration tests
- [x] Run verification
- [x] Update spec/index.yml (status, deps if changed)

## Verification
- dotnet test --filter MobileGroupLocations
- curl -H "Authorization: Bearer <token>" -H "Content-Type: application/json" -X POST http://localhost:5000/api/mobile/groups/<id>/locations/latest -d "{}"

## Notes
Keep responses additive and aligned with existing /api/groups behaviour to avoid regressions.
